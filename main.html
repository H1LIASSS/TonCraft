<!DOCTYPE html>
<head>
    <title>TonCraft</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="content/logotype.png" />
    <link rel="stylesheet" href="css/defaultvalues.css">
    <link rel="stylesheet" href="css/mainstyles.css">
    <link rel="script" href= "./stars.js">

    <script>
    var userLang = navigator.language || navigator.userLanguage; 
    var online = 0;   
    if(userLang!="ru")
        userLang = "en";
    </script>
    <html lang=userLang>

     
</head>
<body>
  <div class="stars"> 
    <script>
        const fallSpeed = 300; // Скорость падения в пикселях
        function changeLanguage(){
            document.getElementById("lang").value="RU";
        }
        function createStar(x, y) {
            const star = document.createElement('div');

            star.classList.add('star');
            star.style.left = `${x}px`;
            star.style.top = `${y}px`;

            // Задаем размер звездочкам
            const s = Math.floor(Math.random() * 3 + 3);
            star.style.width = `${s}px`;
            star.style.height = `${s}px`;

            star.style.opacity = 0.2;
            star.style.transition = 'opacity 3s';

            // Вычисляем длительность анимации на основе высоты экрана и скорости падения
            const duration = (window.innerHeight-y) / fallSpeed;
            star.style.animationDuration = `${duration}s`;

            document.body.appendChild(star);

             requestAnimationFrame(() => {
             star.style.opacity = 1;
                });


            // Удаляем звездочку после окончания анимации
            setTimeout(() => {
                star.remove();
            }, duration * 1000);
        }

        function fillScreenWithStars() {
            const cols = 10;
            const rows = 10;
            for (let i = 0; i < cols; i++) {
                for (let j = 0; j < rows; j++) {
                    createStar(Math.random() * window.innerWidth, Math.random() * window.innerHeight);
                }
            }
        }

        function addFallingStars() {
            createStar(Math.random() * window.innerWidth, 0);
        }

        function deleteStars()
        {
              if (document.hidden) 
              {
                const stars = document.querySelectorAll('.star');
                stars.forEach(star => star.remove());
              } 
              else
              {
                fillScreenWithStars();
              }
        }

        // Заполняем экран звездочками при загрузке
        fillScreenWithStars();

        // Добавляем новые звездочки каждую секунду
        setInterval(addFallingStars, 25);

        document.addEventListener("visibilitychange",deleteStars);


        
    function addCharacter(){//spawn new char
    }

    function deleteCharacter() {//delete character 
    }

    async function checkServerStatus() {
        const response = await fetch('https://api.mcsrvstat.us/2/95.216.62.170:25822');
        const data = await response.json();
        const statusElements = document.getElementsByClassName('my-server-status');
        
        if (statusElements.length > 0) {
            const statusDiv = statusElements[0]; // Предполагаем, что у вас один элемент с этим классом
            
            if (data.online) {
                
                if(data.online>online)
                {addCharacter();}
                else if(data.online<online)
                {deleteCharacter();}

                online = data.online;
                statusDiv.innerHTML = `Сервер онлайн! Игроков: ${online}/${data.players.max}`;
            } else {
                statusDiv.innerHTML = 'Сервер оффлайн';
            }
        }
    }

    checkServerStatus();


</script>



  <div class="navbar">  
    <div class = "upperbuttons">
        <div class = 'leftside'>
                <button class="btn",id="lang", onclick = "changeLanguange()">EN</button>

        <div class="dropdown">
                <button class="dropbtn">Other</button>
                <div class="dropdown-content">
                    <a href="#", onclick="location.href='./partners.html'"\>Partners</a>
                </div>
        </div> 

        </div>
    <div class='logo'>TonCraft</div>
        <div class = 'rightside'>
            <button class="btn", onclick="location.href='./map.html'">Map</button>     
            <button class="btn", onclick="location.href='./donate.html'">Donate</button>
            <button class="btn", onclick="location.href='./earn.html'">Earn</button>
        </div>
    </div>
   </div>
   <div class="container"> 
      <img src="content/earth.png", class = "move-up-down"/>
   </div>
</body>
</html>